REPORT ZRAJU_PRGM4_JOINS.
TABLES VBAK.
TYPES : BEGIN OF LS_TAB,
        VBELN TYPE VBELN_VA,
        ERNAM TYPE ERNAM,
        VBTYP TYPE VBTYP,

        MATNR TYPE MATNR,
        MATWA TYPE MATWA,
        CHARG TYPE CHARG_D,

  END OF LS_TAB.

  DATA: LT_TAB TYPE STANDARD TABLE OF LS_TAB,
        WA_TAB TYPE LS_TAB.
  SELECT-OPTIONS S_VBELN FOR VBAK-VBELN.
  START-OF-SELECTION .

  SELECT  VBAK~VBELN VBAK~ERNAM VBAK~VBTYP VBAP~MATNR VBAP~MATWA VBAP~CHARG INTO TABLE LT_TAB  FROM VBAK  INNER JOIN VBAP ON VBAK~VBELN = VBAP~VBELN WHERE  VBAK~VBELN IN S_VBELN.

    IF SY-SUBRC EQ 0.
      WRITE :/ 'COMMAND EXECUTED SUCCESSFULLY',SY-DBCNT.
      ELSE.
        WRITE:/ 'ERROR IN FETCHING'.
    ENDIF.
    END-OF-SELECTION.
    LOOP AT LT_TAB INTO WA_TAB.
      WRITE:/ WA_TAB-VBELN ,WA_TAB-ERNAM,WA_TAB-VBTYP,WA_TAB-MATNR,WA_TAB-MATWA,WA_TAB-CHARG.
      ENDLOOP.